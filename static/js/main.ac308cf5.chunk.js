(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{121:function(e,t,n){},122:function(e,t,n){},124:function(e,t,n){},128:function(e,t){},130:function(e,t){},140:function(e,t){},142:function(e,t){},169:function(e,t){},171:function(e,t){},172:function(e,t){},177:function(e,t){},179:function(e,t){},185:function(e,t){},187:function(e,t){},206:function(e,t){},218:function(e,t){},221:function(e,t){},225:function(e,t,n){},226:function(e,t,n){},227:function(e,t,n){},228:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n.n(c),r=n(113),o=n.n(r),i=(n(121),n(116)),u=n(16),s=(n(122),n(2)),f=function(e){var t=e.sendMessage,n=Object(c.useState)(""),a=Object(u.a)(n,2),r=a[0],o=a[1];return Object(s.jsxs)("form",{className:"diaInput",action:"#",onSubmit:function(e){e.preventDefault(),""!==r&&(t(r),o(""))},children:[Object(s.jsx)("input",{type:"text",onChange:function(e){o(e.target.value)},value:r}),Object(s.jsx)("button",{children:">"})]})},l=(n(124),{Waifu:{clr:"#FDBC00"},Semen:{clr:"#3DD643"}}),d=function(e){var t=e.dialog,n=Object(c.useRef)();return Object(c.useEffect)((function(){(null===n||void 0===n?void 0:n.current)&&(n.current.scrollTop=n.current.scrollHeight)}),[t]),Object(s.jsx)("section",{className:"dialog",ref:n,children:t.map((function(e){var t=e.character_name,n=e.text,c=e.pk;return Object(s.jsxs)("div",{className:"dialogEntry ".concat("Waifu"===t?"Waifu":""),children:[Object(s.jsx)("h4",{style:{color:l[t].clr},className:"character_name",children:t}),Object(s.jsx)("div",{className:"text",children:Object(s.jsx)("p",{children:n})})]},c)}))})},p=n(114),b=n(59),m=n.n(b),j=n(115),O=(n.p,n.p+"static/media/background.4fd85e44.jpg"),h={happy:{img:n.p+"static/media/waifu_happy.eae5a9bf.png"},positive:{img:n.p+"static/media/waifu-positive.3c8b2285.mp4"},standart:{img:n.p+"static/media/waifu-standart.db35702b.mp4"},negative:{img:n.p+"static/media/waifu-negative.8f105a61.mp4"}},v=(n(225),function(e){e.position;var t=e.character,n=e.emotion;return console.log(t[n].img),Object(s.jsx)("video",{className:"character left",autoPlay:!0,loop:!0,muted:!0,children:Object(s.jsx)("source",{src:t[n].img,type:"video/mp4"})})}),g=(n(226),n(227),function(){var e=Object(c.useState)([{text:"Nyet",character_name:"Waifu",pk:"1"},{text:"Pamagi",character_name:"Semen",pk:"2"},{text:"Whoooma apoooma a aboba perdola. Superhyper gigachad. Hhuy uu ii asli epasue. Saoeurp.",character_name:"Semen",pk:"3"}]),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),o=Object(u.a)(r,2),l=o[0],b=o[1],g=Object(c.useState)("standart"),S=Object(u.a)(g,2),x=S[0],_=S[1],E=function(e){a((function(t){return[].concat(Object(i.a)(t),[e])}))};!function(e,t){var n=function(){var e=Object(j.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"https://Catwaifu-and-bowl-of-rice.github.io/CRMHack",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).CHAT_API,"/chats/"));case 3:return e.next=5,e.sent.json();case 5:if(t=e.sent,0!==(n=Object.values(t.chats)).length){e.next=10;break}return console.error("/chats/ is empty :C"),e.abrupt("return");case 10:return e.abrupt("return",n[0]);case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),a=Object(c.useCallback)((function(e,n){if(!e)return console.error("Chat is undefined");t(e.account),console.log("SET ACCOUNT"),n((function(){return e.messages.sort((function(e,t){return Number(e.timestamp)-Number(t.timestamp)})).map((function(e){return{text:e.text,pk:e.pk,character_name:"Waifu"}}))}))}),[t]);Object(c.useEffect)((function(){n().then((function(t){return a(t,e)}),(function(e){return console.error(e)}))}),[e,a])}(a,b);var T=function(e,t,n){var a=Object(c.useRef)(null);return Object(c.useEffect)((function(){if(!t)return console.error("Account is undefined");var c=new WebSocket("".concat(Object({NODE_ENV:"production",PUBLIC_URL:"https://Catwaifu-and-bowl-of-rice.github.io/CRMHack",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).WS_CHAT_API,"/chats/").concat(t));a.current=c,c.onopen=function(e){console.log("SOCKET OPENED")},c.onmessage=function(t){var c=t.data;console.log("Received new message",c);var a=c.emotions,r=c.pk,o=c.text,i=function(e){var t=e.NEGATIVE,n=e.NEUTRAL,c=e.POSITIVE;return c>t&&c>n?"positive":t>c&&t>n?"negative":"standart"}(a);n({text:o,pk:r,character_name:"Waifu"}),e(i)}}),[t,e,n]),[function(e){var t;return null===(t=a.current)||void 0===t?void 0:t.send(e)}]}(_,l,E),C=Object(u.a)(T,1)[0];return Object(s.jsx)("div",{className:"App",children:Object(s.jsxs)("div",{className:"novelWrapper",children:[Object(s.jsx)("img",{src:O,className:"bcg",alt:"Background"}),Object(s.jsx)("section",{className:"characters",children:Object(s.jsx)(v,{character:h,emotion:x})}),Object(s.jsx)(d,{dialog:n}),Object(s.jsx)(f,{sendMessage:function(e){E({text:e,character_name:"Semen",pk:Object(p.randomBytes)(8).toString("hex")}),null===C||void 0===C||C(e)}})]})})});o.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(g,{})}),document.getElementById("root"))}},[[228,1,2]]]);
//# sourceMappingURL=main.ac308cf5.chunk.js.map