(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{121:function(e,t,n){},122:function(e,t,n){},124:function(e,t,n){},128:function(e,t){},130:function(e,t){},140:function(e,t){},142:function(e,t){},169:function(e,t){},171:function(e,t){},172:function(e,t){},177:function(e,t){},179:function(e,t){},185:function(e,t){},187:function(e,t){},206:function(e,t){},218:function(e,t){},221:function(e,t){},225:function(e,t,n){},226:function(e,t,n){},227:function(e,t,n){},228:function(e,t,n){"use strict";n.r(t);var c=n(3),a=n.n(c),r=n(113),i=n.n(r),o=(n(121),n(116)),u=n(16),s=(n(122),n(2)),f=function(e){var t=e.sendMessage,n=Object(c.useState)(""),a=Object(u.a)(n,2),r=a[0],i=a[1];return Object(s.jsxs)("form",{className:"diaInput",action:"#",onSubmit:function(e){e.preventDefault(),""!==r&&(t(r),i(""))},children:[Object(s.jsx)("input",{type:"text",onChange:function(e){i(e.target.value)},value:r}),Object(s.jsx)("button",{children:">"})]})},l=(n(124),{Waifu:{clr:"#FDBC00"},Semen:{clr:"#3DD643"}}),p=function(e){var t=e.dialog,n=Object(c.useRef)();return Object(c.useEffect)((function(){(null===n||void 0===n?void 0:n.current)&&(n.current.scrollTop=n.current.scrollHeight)}),[t]),Object(s.jsx)("section",{className:"dialog",ref:n,children:t.map((function(e){var t=e.character_name,n=e.text,c=e.pk;return Object(s.jsxs)("div",{className:"dialogEntry ".concat("Waifu"===t?"Waifu":""),children:[Object(s.jsx)("h4",{style:{color:l[t].clr},className:"character_name",children:t}),Object(s.jsx)("div",{className:"text",children:Object(s.jsx)("p",{children:n})})]},c)}))})},m=n(114),d=n(59),j=n.n(d),b=n(115),h=(n.p,n.p+"static/media/background.4fd85e44.jpg"),O={happy:{img:n.p+"static/media/waifu_happy.eae5a9bf.png"},positive:{img:n.p+"static/media/waifu-positive.3c8b2285.mp4"},standart:{img:n.p+"static/media/waifu-standart.db35702b.mp4"},negative:{img:n.p+"static/media/waifu-negative.8f105a61.mp4"}},v=(n(225),function(e){e.position;var t=e.character,n=e.emotion;return console.log(t[n].img),Object(s.jsx)("video",{className:"character fullscreen",autoPlay:!0,loop:!0,muted:!0,children:Object(s.jsx)("source",{src:t[n].img,type:"video/mp4"})})}),g=(n(226),n(227),function(){var e=Object(c.useState)([{text:"Nyet",character_name:"Waifu",pk:"1"},{text:"Pamagi",character_name:"Semen",pk:"2"},{text:"Whoooma apoooma a aboba perdola. Superhyper gigachad. Hhuy uu ii asli epasue. Saoeurp.",character_name:"Semen",pk:"3"}]),t=Object(u.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),i=Object(u.a)(r,2),l=i[0],d=i[1],g=Object(c.useState)("standart"),x=Object(u.a)(g,2),k=x[0],S=x[1],w=function(e){a((function(t){return[].concat(Object(o.a)(t),[e])}))};!function(e,t){var n=function(){var e=Object(b.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fetch("".concat("http://crmhack-chat.azurewebsites.net/api","/chats/"));case 3:return e.next=5,e.sent.json();case 5:if(t=e.sent,console.log("FETCHED CHATS",t),0!==(n=Object.values(t.chats)).length){e.next=11;break}return console.error("/chats/ is empty :C"),e.abrupt("return");case 11:return e.abrupt("return",n[0]);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=Object(c.useCallback)((function(e,n){if(!e)return console.error("Chat is undefined");t(e.account),console.log("SET ACCOUNT"),n((function(){return e.messages.sort((function(e,t){return new Date(e.timestamp).valueOf()-new Date(t.timestamp).valueOf()})).map((function(e){return{text:e.text,pk:e.pk,character_name:"Waifu"}}))}))}),[t]);Object(c.useEffect)((function(){n().then((function(t){return a(t,e)}),(function(e){return console.error(e)}))}),[e,a])}(a,d);var E=function(e,t,n){var a=Object(c.useRef)(null);return Object(c.useEffect)((function(){if(!t)return console.error("Account is undefined");var c=new WebSocket("".concat("ws://crmhack-chat.azurewebsites.net/api","/chats/").concat(t));a.current=c,c.onopen=function(e){console.log("SOCKET OPENED")},c.onmessage=function(t){var c=t.data;console.log("Received new message",c);var a=c.emotions,r=c.pk,i=c.text,o=function(e){var t=e.NEGATIVE,n=e.NEUTRAL,c=e.POSITIVE;return c>t&&c>n?"positive":t>c&&t>n?"negative":"standart"}(a);n({text:i,pk:r,character_name:"Waifu"}),e(o)}}),[t,e,n]),[function(e){var t;return null===(t=a.current)||void 0===t?void 0:t.send(e)}]}(S,l,w),N=Object(u.a)(E,1)[0];return Object(s.jsx)("div",{className:"App",children:Object(s.jsxs)("div",{className:"novelWrapper",children:[Object(s.jsx)("img",{src:h,className:"bcg",alt:"Background"}),Object(s.jsx)("section",{className:"characters",children:Object(s.jsx)(v,{character:O,emotion:k})}),Object(s.jsx)(p,{dialog:n}),Object(s.jsx)(f,{sendMessage:function(e){w({text:e,character_name:"Semen",pk:Object(m.randomBytes)(8).toString("hex")}),null===N||void 0===N||N(e)}})]})})});i.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(g,{})}),document.getElementById("root"))}},[[228,1,2]]]);
//# sourceMappingURL=main.a7df4ae5.chunk.js.map